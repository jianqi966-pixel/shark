<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>åŸå­é‡ç»„å®éªŒå®¤ - çŒ®ç»™æ­†æƒ </title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <style>
        .custom-scrollbar::-webkit-scrollbar { width: 2px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: rgba(59, 130, 246, 0.3); border-radius: 10px; }
        body { background-color: #020617; margin: 0; overflow: hidden; -webkit-tap-highlight-color: transparent; }
        .diamond-shadow { filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.5)); }
    </style>
</head>
<body>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const apiKey = ""; // Gemini API è¿è¡Œæ—¶è‡ªåŠ¨æ³¨å…¥

        const App = () => {
            const [day, setDay] = useState(0);
            const [isRefining, setIsRefining] = useState(false);
            const [progress, setProgress] = useState(0);
            const [status, setStatus] = useState("é‡å­æ ¸å¿ƒå¾…å‘½");
            const [logs, setLogs] = useState(["> ç³»ç»Ÿå°±ç»ª", "> ç›®æ ‡ï¼šæ­†æƒ "]);
            const [aiMsg, setAiMsg] = useState("");
            const [loadingAi, setLoadingAi] = useState(false);
            
            const audioCtx = useRef(null);
            const logEndRef = useRef(null);

            useEffect(() => { logEndRef.current?.scrollIntoView({ behavior: "smooth" }); }, [logs]);

            const getGeminiMsg = async () => {
                if (loadingAi) return;
                setLoadingAi(true);
                const prompt = `ä½ æ˜¯ä¸€ä¸ªå……æ»¡æµªæ¼«ç»†èƒçš„é‡å­ç‰©ç†å­¦å®¶ã€‚æ­£åœ¨è¿›è¡Œå®éªŒï¼šå°†â€˜å»ºé½â€™é‡ç»„ä¸ºâ€˜æ­†æƒ â€™ã€‚ç°åœ¨æ˜¯ç¬¬${day}å¤©ã€‚è¯·å†™ä¸€å¥ç»™æ­†æƒ çš„ã€ç§‘æŠ€æ„Ÿåè¶³ä¸”æ·±æƒ…çš„é¼“åŠ±ï¼Œ15å­—ä»¥å†…ã€‚`;
                try {
                    const resp = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
                    });
                    const data = await resp.json();
                    const text = data.candidates?.[0]?.content?.parts?.[0]?.text || "é‡å­çº ç¼ æ„Ÿåº”ä¸­...";
                    setAiMsg(text);
                    setLogs(p => [...p, `[AI] ${text}`]);
                } catch (e) { setAiMsg("èƒ½é‡åœºæ³¢åŠ¨..."); }
                finally { setLoadingAi(false); }
            };

            const runRefinery = async () => {
                if (isRefining) return;
                setIsRefining(true); setDay(0); setProgress(0); setLogs(["> å¼€å¯é«˜å‹ç¯å¢ƒ..."]);
                for (let i = 1; i <= 7; i++) {
                    await new Promise(r => setTimeout(r, 800));
                    setDay(i); setProgress((i / 7) * 100);
                    if (i < 7) {
                        setLogs(p => [...p, `> ç¬¬ ${i} å‘¨æœŸï¼šç¢³é“¾å‹ç¼©ä¸­...`]);
                        setStatus("åˆ†å­é‡ç»„ä¸­");
                    } else {
                        window.confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
                        setLogs(p => [...p, "> å‡åå®Œæˆï¼šå»ºé½ â†’ æ­†æƒ "]);
                        setStatus("è¾¾æˆï¼šæ°¸æ’ä¹‹é’»");
                    }
                }
                setIsRefining(false);
            };

            return (
                <div className="min-h-screen flex items-center justify-center p-6 text-slate-100">
                    <div className="w-full max-w-sm bg-slate-900/60 backdrop-blur-2xl border border-white/10 rounded-[3rem] p-8 shadow-2xl relative">
                        <div className="flex justify-between items-center mb-10">
                            <span className="text-[10px] font-mono opacity-40 uppercase">Diamond Pro v2.0</span>
                            <button onClick={getGeminiMsg} disabled={loadingAi} className="text-[9px] border border-blue-500/30 px-3 py-1 rounded-full text-blue-300">
                                {loadingAi ? "æ„Ÿåº”ä¸­..." : "âœ¨ é‡å­å…±é¸£"}
                            </button>
                        </div>

                        <div className="bg-white/5 rounded-[2.5rem] py-12 mb-8 border border-white/5 text-center">
                            <div className={`text-8xl mb-4 transition-all duration-1000 ${day === 7 ? 'scale-110 diamond-shadow' : 'scale-90 opacity-40'}`}>
                                {day === 7 ? 'ğŸ’' : 'âš«'}
                            </div>
                            <h2 className="text-3xl font-black mb-1">{day === 7 ? "æ­†æƒ " : "å»ºé½"}</h2>
                            <p className="text-blue-500 text-[10px] font-bold tracking-[0.3em] uppercase">{status}</p>
                            {aiMsg && <div className="mt-6 px-4 py-2 mx-4 bg-blue-500/10 border border-blue-500/20 rounded-xl text-[10px] text-blue-200 italic">â€œ{aiMsg}â€</div>}
                        </div>

                        <div className="mb-8 px-1">
                            <div className="flex justify-between items-end mb-2 font-mono">
                                <span className="text-2xl font-bold">{Math.round(progress)}%</span>
                                <span className="text-[10px] opacity-40">Phase 0{day}/07</span>
                            </div>
                            <div className="h-1 bg-slate-800 rounded-full overflow-hidden">
                                <div className="h-full bg-blue-500 transition-all duration-700" style={{ width: `${progress}%` }}></div>
                            </div>
                        </div>

                        <button onClick={runRefinery} disabled={isRefining} className="w-full py-5 rounded-[1.5rem] bg-white text-slate-950 font-black text-xs uppercase tracking-widest active:scale-95 transition-all">
                            {isRefining ? "æ­£åœ¨é‡æ„..." : (day === 7 ? "é‡ç»„å·²åœ†æ»¡" : "å¯åŠ¨åŸå­é‡ç»„")}
                        </button>
                    </div>
                </div>
            );
        };
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
